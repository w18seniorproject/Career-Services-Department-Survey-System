<!DOCTYPE html>
<html lang=en>

<head>
    <title>Administrator Login</title>
    <meta charset="utf-8">
    <script src="../JQuery/jquery-3.3.1.min.js"></script>
    <script src="../Bootstrap/bootstrap-3.3.7/dist/js/bootstrap.min.js"></script>
    <meta name="viewport" content="width=device-width, height=device-height, initial-scale=1">
    <link rel="stylesheet" type="text/css" href="../Bootstrap/bootstrap-3.3.7/dist/css/bootstrap.min.css">
    <link href="../CSS/styles.css" rel="stylesheet" type="text/css">
    <script type="text/javascript" src="../scripts/utils.js"></script>
    <script>
        $(function () {
            $("#header").load("../header.html");
        });
    </script>
</head>

<body>
    <script type="text/javascript">
        $.ajax({
            url: "../index.php",
            cache: false,
            data: {pReqType: "getLoginStatus"},
            type: "POST",
            success: function(response){
                if(response.includes("TRUE")){
                    window.location = "pDashboard.html";
                }
            },
            error: function(jqxr, status, exception){
                alert("Failure in getLoginStatus ajax call in pLogin.html: " + exception);
            }
        });
    </script>
        
    <div id="header"></div>

    <div class="form-centered">
        <legend class="legend">Survey Administrator Login</legend>
        <!--<form id="submitInput" action="../index.php" method="post" onsubmit="numericHash()"> -->
            <form action="../index.php" method="post">

            <input class="form-control input-lg" placeholder="Username" type="text" name="username">
            <br>
            <input id="password" class="form-control input-lg" placeholder="Password" type="password" name="pword">
            <br>
            <input class="btn btn-primary btn-lg btn-block" type="submit" value="Submit">
            <input type="hidden" value="POLL" name="aType">
            <input type="hidden" value="LOGIN" name="pReqType">
        </form>
        <br>
        <p id="errorMessage" class="errorMessage"></p>
        <script type="text/javascript">

            var response = getUrlParameter("response");
            var string = getUrlParameter("error");
            var message = "";

            if (string == "wrongAuth") {
                message = "Wrong Username/Password. Please try again."
            }
            else if (string == "notUnique") {
                message = "devteam messed up. Usernames/Passwords aren't unique";
            }
            document.getElementById("errorMessage").innerText = message;

            if (response == "emailSent") {
                alert("A link has been sent to the email address associated with this account.");
            }
        </script>

        <p style="text-align: center">

            <i>
                <a id="forgotPword" class="hyperlink" href="forgotPassword.html"> forgot username / password? </a>
            </i>

        </p>
    </div>
</body>

</html>